# 🔍 The Invisible RDP: Suspected RDP Compromise and LOLBin-Based Exfiltration

**Analyst:** Peter Van Rossum  
**Date Range Investigated:** July 2–3, 2025  
**Target Device:** `windows-target-1`  
**Internal IP:** `10.0.0.5`  
**External IP Involved:** `88.214.25.19`  

---

## ⚠️ Limitations & Considerations

This investigation was conducted within the context of a CyberRange lab environment. While the behaviors observed (including external RDP access and suspicious use of `svchost.exe`) strongly resemble post-compromise activity seen in real-world attacks, it is possible that:

- Some or all of these behaviors are part of a **deliberate red team simulation** or threat emulation setup  
- The system was **intentionally exposed** to simulate insecure RDP posture  
- Certain anomalies (e.g., missing telemetry or SmartSignal-only detections) may reflect **lab configurations** or simulated data gaps  

However, based on the observed persistence, volume, and pattern of activity, this behavior warrants investigation and is documented here for its instructional and analytical value. Findings are framed with these limitations in mind.

---

## 🎯 Objective

This threat hunt was initiated after a series of failed login attempts were observed targeting `windows-target-1`. While performing routine investigation in Microsoft Defender for Endpoint, a manual pivot on one of the external IP addresses involved in the login attempts (`88.214.25.19`) revealed an **unexpected successful connection**.

The goal of this hunt was to determine:
- Whether a public IP address had successfully established an RDP session with the internal host  
- Whether any signs of post-compromise activity or persistence were present  
- How this behavior may have evaded standard Defender telemetry  

---

## 🧭 Investigation Timeline and Findings

### ✅ 1. Discovery of Suspicious Inbound RDP Connection

While reviewing sign-in data, I manually pivoted into the **"Observed in organization"** tab for IP address `88.214.25.19` in the Defender portal. There, I found this event:

> `svchost.exe accepted connection from 88.214.25.19:57706 to 10.0.0.5:3389`

![Initial evidence of inbound RDP from external IP](./InitialEvidence1.png)

- Port `3389` is used for **Remote Desktop Protocol (RDP)**.  
- The connection was **inbound from the public internet**, suggesting **RDP was exposed externally**.  
- `svchost.exe` was recorded as the receiving process, which is atypical — RDP sessions are normally handled by `TermService` and related components, not `svchost.exe` directly.  

**Why this is concerning:**  
The involvement of `svchost.exe` in accepting a remote RDP connection strongly suggested **process misuse, injection, or lateral movement activity**, especially in combination with an external IP and no interactive login session recorded.

---

### 🔍 2. Attempts to Corroborate the Event in KQL

Despite the successful RDP event shown in the portal, I was unable to locate it in any Advanced Hunting table:

```kql
DeviceNetworkEvents
| where DeviceName == "windows-target-1"
| where RemoteIP == "88.214.25.19"
| where RemotePort == 3389 or LocalPort == 3389
```

```kql
DeviceEvents
| where DeviceName == "windows-target-1"
| where RemoteIP == "88.214.25.19"
```

This absence of telemetry led to the hypothesis that this was a **cloud-side correlation detection**, likely generated by Microsoft Defender’s SmartSignals or backend enrichment — **not direct endpoint telemetry**.

---

### 🔐 3. Sequence of Failed RDP Logon Attempts from `88.214.25.19`

To assess whether the successful RDP connection from `88.214.25.19` was preceded by brute-force behavior, I queried the Defender `DeviceLogonEvents` table for failed authentication attempts from that IP:

```kql
DeviceLogonEvents
| where DeviceName == "windows-target-1"
| where RemoteIP == "88.214.25.19"
| where ActionType == "LogonFailed"
| project Timestamp, RemoteIP, DeviceName, ActionType
| order by Timestamp desc
```

The results (shown below) reveal **a clear burst of failed login attempts** on **July 2, 2025**, between **09:06 and 09:16 UTC**, all originating from `88.214.25.19`:

![Failed RDP logons from external IP](./FailedLogins.png)

> This sequence strongly suggests **brute-force activity**, with the external actor attempting multiple RDP logins in rapid succession. The presence of a **successful inbound RDP connection shortly afterward**, handled suspiciously by `svchost.exe`, adds weight to the likelihood of a **successful credential compromise**.

---

### 🕳️ 4. Absence of Successful Login Events from Attacker IP

Despite Defender's portal surfacing an RDP connection from `88.214.25.19` to port `3389`, **no successful login was recorded** in the `DeviceLogonEvents` table:

```kql
DeviceLogonEvents
| where DeviceName == "windows-target-1"
| where RemoteIP == "88.214.25.19"
| where ActionType == "LogonSuccess"
```

This query returned **no results**, which is unexpected behavior in a legitimate RDP session.

> This absence supports the hypothesis that the attacker may have used **non-interactive logon methods**, **token theft**, or **process injection** to gain access without triggering a standard logon event. Combined with the presence of a `svchost.exe` network listener on port 3389, this points to **post-compromise activity using stealth techniques**.

---

## 🧠 5. Why This Is a High-Fidelity Threat Signal

Several combined signals point to a likely compromise, even in the absence of full telemetry:

- The attack began with a **successful inbound RDP connection** from a suspicious external IP (`88.214.25.19`)  
- No interactive sign-in logs were recorded, suggesting use of **token theft, session hijacking, or process injection**  
- The RDP session was handled by `svchost.exe`, an unusual receiving process that may indicate **masquerading or process hollowing**  
- Defender’s **SmartSignal detection** surfaced the event, while raw telemetry remained absent — a hallmark of **evasion-aware tradecraft**

Taken together, these patterns strongly resemble known **living-off-the-land (LotL) tactics** used by attackers to maintain stealthy, persistent control of a compromised system.

---

## 📌 Conclusion

This investigation uncovered strong signs of post-compromise activity, including:

- External RDP session from a suspicious IP  
- Masquerading of service behavior under `svchost.exe`  
- Absence of telemetry, implying deliberate evasion or detection via backend logic  

These are strong indicators of a **compromised host under attacker control**, using **living-off-the-land techniques** to maintain persistence and conceal activity.

---

## 🧩 Recommendations (if it is/were an actual compromise in a real-world situation)

- Isolate `windows-target-1` from the network  
- Perform memory capture and full disk imaging for forensic review  
- Audit all autoruns, services, scheduled tasks, and WMI persistence points  
- Rotate credentials associated with the machine  
- Block RDP at the NSG/firewall unless explicitly needed  

---

_Report generated by Peter Van Rossum, July 3, 2025_
